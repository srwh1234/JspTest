<!DOCTYPE html>
<html lang="zh-Hant">

<head>
  <title>TripLight | ShoppingCar</title>
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta charset="utf-8" />
  <!-- 關鍵字設定 -->
  <meta name="keywords" content="旅遊, 行程規劃, 票券, AI, ChatGPT, Google map, 客製化行程, 套裝行程" />
  <!-- 網頁介紹 -->
  <meta name="description" content="我們提供旅遊行程規劃服務，以及販售套裝行程 票券 等等" />

  <script>
    addEventListener(
      "load",
      function () {
        setTimeout(hideURLbar, 0);
      },
      false
    );

    function hideURLbar() {
      window.scrollTo(0, 1);
    }
  </script>

  <!--jQuery-->
  <link href="https://code.jquery.com/ui/1.10.4/themes/ui-lightness/jquery-ui.css" rel="stylesheet">
  <script src="https://code.jquery.com/jquery-1.10.2.js"></script>
  <script src="https://code.jquery.com/ui/1.10.4/jquery-ui.js"></script>
  <!-- <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.2.3/dist/js/bootstrap.bundle.min.js"
          integrity="sha384-kenU1KFdBIe4zVF0s0G1M5b4hcpxyD9F7jL+jjXkk+Q2h455rYXK/7HAuoJl+0I4"
          crossorigin="anonymous"></script> -->
  <!--會員登入-->
  <link href="css/login.css" rel="stylesheet" />

  <!-- css files -->
  <link href="css/bootstrap.css" rel="stylesheet" type="text/css" />
  <!-- bootstrap css -->
  <link href="css/style.css" rel="stylesheet" type="text/css" />
  <!-- custom css -->
  <link href="css/fontawesome-all.css" rel="stylesheet" />
  <!-- fontawesome css -->
  <!-- //css files -->

  <!-- google fonts -->
  <!-- 載入字體 -->
  <link rel="preconnect" href="https://fonts.googleapis.com" />
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
  <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+TC&display=swap" rel="stylesheet" />
  <!-- //google fonts -->

  <!-- 載入icon -->
  <link rel="shortcut icon" href="./images/icon.png" />
  <link rel="bookmark" href="./images/icon.png" />


  <style>
    img {
      max-width: 100%;
      height: 100%;
      object-fit: contain;
    }



    .container-fluid {
      background-color: #f5f5f5;
    }

    .container-fluid .container {
      background-color: #fff;
    }

    #orderContainer,
    #emptyText {
      border: 1px solid lightgray;
      border-radius: 5px;
    }

    .order-item {
      height: 12rem;
    }

    /* 顯示幾行文字 */
    .order-item div.h6 {
      display: -webkit-box;
      -webkit-line-clamp: 2;
      -webkit-box-orient: vertical;
      overflow: hidden;
      text-overflow: ellipsis;
    }

    /* 顯示幾行文字 */
    .order-item .text-muted {
      display: -webkit-box;
      -webkit-line-clamp: 3;
      -webkit-box-orient: vertical;
      overflow: hidden;
      text-overflow: ellipsis;
    }

    /* 文字水藍 */
    .my-text-lightblue {
      color: #26bec9;
    }

    /* 文字淺紅 */
    .my-text-lightred {
      color: #ef7a70;
    }

    .btn-minus,
    .btn-plus {
      border: #26bec9;
      color: white;
      background-color: #26bec9;
    }

    .btn-minus:hover,
    .btn-plus:hover,
    .btn-minus:focus,
    .btn-plus:focus {
      border: #26bec9;
      background-color: #09777d;
    }


    .btn-del {
      border: #ef7a70;
      color: white;
      background-color: #ef7a70;
    }


    .btn-del:hover,
    .btn-del:focus {
      border: #f14131;
      background-color: #f14131;
    }

    #btnCheckOut,
    #btnCheckOut2,
    #btnBack,
    #btnOrder,
    #btnDeleteConfirm {
      border: #26bec9;
      color: white;
      background-color: #26bec9;
    }

    #emptyContainer img {
      background-color: #eee;
    }
  </style>
</head>

<body>
  <!-- header -->
  <header>
    <div class="container" style="padding-right: 0px">
      <!-- nav -->
      <nav class="py-md-4 py-3">
        <div id="logo">
          <h1 class="mt-md-0 mt-2">
            <a href="index.html"><img src="./images/icon.png" class="icon_triplight" />
              TripLight
            </a>
          </h1>
        </div>
        <label for="drop" class="toggle"><span class="fa fa-bars"></span></label>
        <input type="checkbox" id="drop" />
        <ul class="menu ml-auto mt-1">
          <li class=""><a href="index.html">首頁</a></li>
          <li class=""><a href="booking.html">AI行程規劃</a></li>
          <li class=""><a href="tickets.html">票券</a></li>
          <li class=""><a href="itinerary_search.html?index=1">套裝行程</a></li>
          <li class=""><a href="articles.html">旅遊文章</a></li>
          <li class="booking"><a href="" id="login">登入/註冊</a></li>
          <li class="active">
            <a href="shopping_car.html"><img src="./images/shoppingCar.svg" alt="" style="width: 2em" /></a>
          </li>
        </ul>
      </nav>
      <!-- //nav -->
      <div class="member">
        <ul class="member_list">
          <li class="member_li"><a href="login.html"><i class="fa-regular fa-user"></i>管理帳戶</a>
          </li>
          <li class="member_li" id="order_li"><a href=""><i class="fa-solid fa-plane"></i>訂單管理</a>
            <ul class="order_list">
              <li class="order_content"><a href="tickets_order.html"><i class="fa-solid fa-ticket"></i>票券訂單</a></li>
              <li class="order_content"><a href="group_order.html"><i class="fa-solid fa-suitcase"></i>旅遊團訂單</a>
              </li>
            </ul>
          </li>
          <li class="member_li"><a href="my_favorite.html"><i class="fa-regular fa-heart"></i>我的收藏</a></li>
          <li class="member_li"><a href="article_myfavorite.html"><i class="fa-solid fa-copy"></i>我的文章</a></li>
          <li class="member_li"><a href="membership_rating.html"><i class="fa-regular fa-gem"></i>會員分級</a></li>
          <li class="member_li"><a href="question_form.html"><i class="fa-regular fa-comment"></i>提出問題</a></li>
          <li class="member_li"><a href="read_question_list.html"><i class="fa-regular fa-comment"></i>查看問題</a></li>
          <li class="member_li" id="logout_li"><a href=""><i class="fa-solid fa-right-from-bracket"></i>登出</a>
          </li>
        </ul>
      </div>
    </div>
  </header>
  <!-- //header -->
  <!-- 登入 -->
  <div id="login-container">
    <!---container--->

    <div class="main-box login">
      <h3>登入</h3>
      <form action="">
        <div class="input-box">
          <i class="fas fa-envelope icon2"></i> <input type="email" name="email" id="email" required /> <label
            for="">信箱</label>
        </div>
        <div class="input-box">
          <i class="fas fa-lock icon2"></i> <input type="password" name="password" id="password" required />
          <label for="">密碼</label>
        </div>
        <div class="check">
          <label><input type="checkbox" />記住我</label> <a href="#" id="forgetPwd">忘記密碼</a>
        </div>
        <button type="submit" class="main-btn">Login</button>
        <div class="register">
          <p>
            如果沒有帳號?<a href="#" class="register-link">點擊註冊</a>
          </p>
        </div>
      </form>
    </div>

    <div class="main-box register">
      <h3>註冊</h3>
      <form action="">
        <div class="input-box">
          <i class="fas fa-user icon2"></i> <input type="email" name="account" id="register_account" required /> <label
            for="">使用者名稱</label>
        </div>
        <div class="input-box">
          <i class="fas fa-envelope icon2"></i> <input type="email" name="email" id="register_email" required /> <label
            for="">信箱</label>
        </div>
        <div class="input-box">
          <i class="fas fa-lock icon2"></i> <input type="password" name="password" id="register_password" required />
          <label for="">密碼</label>
          <h6 id="pwdHint">密碼設定請超過八碼</h6>
        </div>
        <div class="check">
          <label><input type="checkbox" />我同意所有條款</label>
        </div>
        <button type="submit" class="main-btn">註冊</button>
        <div class="register">
          <p>
            已經有帳號?<a href="#" class="login-link">點擊登入</a>
          </p>
        </div>
      </form>
    </div>

    <span class="close-icon">
      <div class="fas fa-times"></div>
    </span>
  </div>
  <!-- 登入  -->
  <!-- banner -->
  <section class="banner_inner" id="home">
    <div class="banner_inner_overlay"></div>
  </section>
  <!-- //banner -->

  <div class="container-fluid">

    <!--     <div class="position-fixed"> -->
    <!--       <a href="tickets_order.html" class="btn btn-primary rounded-circle" style="width: 7rem; height: 7rem; " -->
    <!--         width="170" height="170" type="button" id="btnOrder">我的訂單</a> -->
    <!--     </div> -->

    <!-- TODO: 這是本體 -->
    <div class="container">
      <div class="row p-3">
        <div class="h3 my-5">票券購物車</div>

        <div class="row d-none" id="emptyContainer">
          <div class="col-12 col-lg-12 py-3 d-flex flex-column" id="emptyText">
            <div class="d-flex justify-content-center mt-5">
              <img src="./images/shoppingCar.svg" class="rounded-circle" width="170" height="170">
            </div>
            <div class="d-flex justify-content-center mt-3">
              <p>您的購物車是空的</p>
            </div>
            <div class="d-flex justify-content-center my-3">
              <a href="index.html" class="btn btn-primary p-3" type="button" id="btnBack">跟著TripLight一起探索世界</a>
            </div>
          </div>
          <div class="text-end my-3">
            <a href="tickets.html" class="my-text-lightblue">繼續購物 &gt;</a>
          </div>
        </div>

        <div class="col-12 col-lg-12 py-3 h-100" id="orderContainer">
          <!-- 內容給JS填 -->
        </div>
      </div>

      <div id="selectContainer">
        <div class="row my-3">
          <div class="col-8 col-lg-4 ms-lg-3 d-flex">
            <select class="form-select" id="discountSelect">
              <!-- 內容給JS填 -->
            </select>
          </div>
          <div class="col-4 col-lg-1">
            <div class="text-muted">小計:<span id="sumSubtotal">1</span></div>
            <div class="text-muted">折扣:<span id="discount">0</span></div>
          </div>
        </div>
      </div>

      <div id="buyContainer">
        <div class="row my-5">
          <div class="col-12 col-lg-6 offset-lg-6 d-flex my-5">
            <div class="h3 align-self-center">
              <span>總金額:</span>
              <span class="my-text-lightblue" id="actualPrice">1</span>
            </div>
            <div class="ms-5 align-self-center">
              <button class="btn btn-primary btn-lg p-3" type="button" id="btnCheckOut">前往結帳(綠界)</button>
            </div>
            <div class="ms-5 align-self-center">
              <button class="btn btn-primary btn-lg p-3" type="button" id="btnCheckOut2">前往結帳</button>
            </div>
          </div>
        </div>
      </div>
    </div>

    <!-- 稱高度用的 -->
    <div style="height:30vh"></div>
    <!-- 給綠界用的 -->
    <div id="myHideDiv" style="display: none;"></div>
  </div>



  <!-- 確認刪除視窗 -->
  <div class="modal fade" id="confirmModal" tabindex="-1">
    <div class="modal-dialog modal-dialog-centered">
      <div class="modal-content">
        <div class="modal-header">
          <h5 class="modal-title my-text-lightred">刪除品項</h5>
          <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
        </div>
        <div class="modal-body">
          確定要刪除[<span class="my-text-lightblue mx-2"></span>]嗎？
        </div>
        <div class="modal-footer">
          <button type="button" class="btn btn-secondary" id="btnDeleteConfirm">確定</button>
        </div>
      </div>
    </div>
  </div>



  <!--footer -->
  <footer>
    <section class="footer footer_w3layouts_section_1its py-5">
      <div class="container py-lg-4 py-3">
        <div class="row footer-top">
          <div class="col-lg-3 col-sm-6 footer-grid_section_1">
            <div class="footer-title">
              <h3>地點資訊</h3>
            </div>
            <div class="row">
              <ul class="col-12 links">
                <li>
                  <a href="https://www.google.com/maps?q=桃園市中壢區復興路46號9樓" target="_blank">地址：桃園市中壢區復興路46號9樓</a>
                </li>
                <li><a href="tel:02-1234-5678">電話：02-1234-5678</a></li>
                <li>
                  <a href="mailto:triplight0411@gmail.com">信箱：triplight0411@gmail.com</a>
                </li>
                <li><a href="tel:02-1234-5678">傳真：02-1234-5678</a></li>
              </ul>
            </div>
          </div>
          <div class="col-lg-3 col-sm-6 footer-grid_section mt-sm-0 mt-4">
            <div class="footer-title">
              <h3>認識TripLight</h3>
            </div>
            <div class="row">
              <ul class="col-10 links">
                <li><a href="about.html" class="scroll">關於我們</a></li>
                <li>
                  <a href="user_terms.html" class="scroll">使用者條款 </a>
                </li>
                <li>
                  <a href="privacy_policy.html" class="scroll">隱私權保護政策</a>
                </li>
                <li><a href="faq.html" class="scroll"> 常見問題與幫助</a></li>
              </ul>
            </div>
          </div>
          <div class="col-lg-3 col-sm-6 mt-lg-0 mt-4 footer-grid_section_1">
            <div class="footer-title">
              <h3>成為合作夥伴</h3>
            </div>
            <div class="row">
              <ul class="col-10 links">
                <li>
                  <a href="supplier_form.html" class="scroll">成為供應商</a>
                </li>
                <li>
                  <a href="blogger_photographer.html" class="scroll">部落客/攝影師合作計畫</a>
                </li>
                <li>
                  <a href="group_form.html" class="scroll">團體客製規劃</a>
                </li>
              </ul>
            </div>
          </div>
          <div class="col-lg-3 col-sm-6 mt-lg-0 mt-4 footer-grid_section_1">
            <div class="footer-title">
              <h3>聯絡我們</h3>
            </div>
            <ul class="social_section_1info">
              <li>
                <a href="https://www.facebook.com/TibaMe"><img src="./images/facebook.svg" alt="facebook" /></a>
              </li>
              <li>
                <a href="https://www.instagram.com/tibame_wiedu/"><img src="./images/instagram.svg"
                    alt="instagram" /></a>
              </li>
              <li>
                <a href="https://twitter.com/"><img src="./images/twitter.svg" alt="twitter" /></a>
              </li>
              <li class="youtube">
                <a href="https://www.youtube.com/channel/UClhecf7eOGHwbKW5e7l_pTA"><img src="./images/youtube.svg"
                    alt="youtube" /></a>
              </li>
            </ul>
          </div>
        </div>
      </div>
    </section>
  </footer>
  <!-- //footer -->

  <!-- copyright -->
  <div class="copyright py-3 text-center">
    <p>COPYRIGHT © 2023 TripLight All rights reserved.</p>
  </div>
  <!-- //copyright -->

  <!-- move top -->
  <div class="move-top text-right">
    <a href="#home" class="move-top">
      <span class="fa fa-angle-up mb-3" aria-hidden="true"></span>
    </a>
  </div>
  <!-- move top -->


  <!-- TODO: 這是正文 -->
  <script src="./js/bootstrap.bundle.min.js"></script>
  <script src="./js/jquery-3.6.4.min.js"></script>
  <script src="./js/sweetalert.js"></script>
  <script src="./js/ticket_login_check.js"></script>
  <script>

    //假資料-購物清單
    let result = [
      {
        quantity: 5,
        ticket: {
          ticketId: 1,
          name: `門票1號`,
          price: (100 * 1),
          available: 10, //可買數量
          description: '票券描述<br>第2行<br>第3行<br>第4行<br>第5行',
          image: `https://picsum.photos/600/600/?random=1`,
          promotion: {
            price: (80 * 1),
            startDate: '2023/06/21',
            endDate: '2023/07/21'
          }
        },
      },
    ];
    let coupons = [
      {
        couponId: 1,
        name: '優惠券1號-100',
        discount: 100
      },
      {
        couponId: 2,
        name: '優惠券2號-200',
        discount: 200
      },
      {
        couponId: 3,
        name: '優惠券3號-400',
        discount: 400
      }
    ];


    //TODO: ------------------------------------------//onload

    $(function () {

      //取得資料
      fetch_data();


      //前往結帳(綠界)的按鈕
      $('#btnCheckOut').on('click', fetch_order);

      //前往結帳的按鈕
      $('#btnCheckOut2').on('click', fetch_order_test);

      //刪除品項的按鈕
      $('#btnDeleteConfirm').on('click', fetch_remove);

      // 減少數量的按鈕點擊事件
      $(document).on('click', '.btn-minus', function () {
        const ticketId = parseInt($(this).data('id'));
        const theText = $(this).closest('.input-group').find('.count-text');
        const val = parseInt($(theText).val());
        if (val > 1) {
          $(theText).val(val - 1);

          fetch_change(ticketId, -1);
          render_subtotal(theText);
          render_price();
        }
      });

      // 增加數量的按鈕點擊事件
      $(document).on('click', '.btn-plus', function () {
        const ticketId = parseInt($(this).data('id'));
        const theText = $(this).closest('.input-group').find('.count-text');
        const max = parseInt($(theText).attr('max'));
        const val = parseInt($(theText).val());
        if (val < max) {
          $(theText).val(val + 1);

          fetch_change(ticketId, 1);
          render_subtotal(theText);
          render_price();
        }
      });

      // 折扣碼選單
      $('#discountSelect').on("change", function () {
        const couponId = parseInt($(this).val());
        let discount = 0;
        if (couponId > 0) {
          discount = coupons.find(e => e.couponId == couponId).discount;
        }
        $("#discount").text(discount);
        render_price();
      });

      //確認刪除視窗的參數傳遞
      $('#confirmModal').on('show.bs.modal', function (event) {
        const id = parseInt($(event.relatedTarget).data('bs-whatever'));
        const ticket_cart = result.find((elem) => elem.ticket.ticketId == id);
        $(".modal-body span").text(ticket_cart.ticket.name);
        $('#btnDeleteConfirm').data('ticket-id', id);
      });
    });


    //TODO: ------------------------------------------//fetch

    /**
    * 取得購物車清單
    */
    function fetch_data() {
      //登入檢查
      const memberId = getMemberId(false);

      fetch(`${getDomainName()}/carts?memberId=${memberId}`)
        .then(response => response.json())
        .then(data => result = data)
        .catch(error => console.log(error))
        .finally(() => render());

      fetch_coupon();
    }

    /**
    * 取得優惠券清單
    */
    function fetch_coupon() {
      //登入檢查
      const memberId = getMemberId(false);

      fetch(`${getDomainName()}/coupons?memberId=${memberId}`)
        .then(response => response.json())
        .then(data => coupons = data)
        .catch(error => console.log(error))
        .finally(() => render_coupons());
    }

    /**
    * 數量更新 
    */
    function fetch_change(ticketId, modify) {
      //登入檢查
      const memberId = getMemberId(false);


      const post = {
        memberId: memberId,
        ticketId: ticketId,
        modify: modify,
      };
      fetch(`${getDomainName()}/modifycart`, {
        method: 'POST',
        headers: {
          'Content-Type': 'application/json'
        },
        body: JSON.stringify(post),
      })
        .then(response => response.json())
        .then(data => {
          if (!data) {
            render();
          }
        })
        .catch(error => console.log(error));
    }

    /**
    *  購物車刪除品項
    */
    function fetch_remove(e) {
      //登入檢查
      const memberId = getMemberId(false);


      const ticketId = parseInt($(e.target).data('ticket-id'));

      fetch(`${getDomainName()}/removecart?memberId=${memberId}&&ticketId=${ticketId}`)
        .then(response => response.json())
        .then(data => fetch_data())
        .catch(error => console.log(error))
        .finally(() => $('#confirmModal').modal('hide'));
    }

    /**
    * 綠界結帳
    */
    function fetch_order() {
      //登入檢查
      const memberId = getMemberId();
      if (!memberId) {
        return false;
      }

      const post = {
        memberId: memberId,
        couponId: parseInt($('#discountSelect').val()),
        backUrl: window.location.href,
      };

      fetch(`${getDomainName()}/ecpayCheckout`, {
        method: 'POST',
        headers: {
          'Content-Type': 'application/json'
        },
        body: JSON.stringify(post),
      })
        .then(response => response.text())
        .then(data => {
          if (data) {
            $('#myHideDiv').html(data);
          } else {
            fetch_data();
          }
        })
        .catch(error => console.log(error));
    }

    /**
    * 測試用結帳
    */
    function fetch_order_test() {
      //登入檢查
      const memberId = getMemberId();
      if (!memberId) {
        return false;
      }
      const couponId = $('#discountSelect').val();

      fetch(`${getDomainName()}/testCheckout?memberId=${memberId}&&couponId=${couponId}`)
        .then(response => response.json())
        .then(data => {
          if (data) {
            Swal.fire({ icon: 'success', title: '結帳成功' });
            // window.location.href = 'tickets_order.html';
          } else {
            Swal.fire({ icon: 'success', title: '結帳失敗' });
          }
        })
        .catch(error => console.log(error))
        .finally(() => fetch_data());
    }

    //TODO:  ------------------------------------------//render
    function render() {

      if (result.length === 0) {
        $('#emptyContainer').removeClass('d-none');
        $('#orderContainer').addClass('d-none');
        $('#selectContainer').addClass('d-none');
        $('#buyContainer').addClass('d-none');
      } else {
        $('#emptyContainer').addClass('d-none');
        $('#orderContainer').removeClass('d-none');
        $('#selectContainer').removeClass('d-none');
        $('#buyContainer').removeClass('d-none');
      }



      $('#orderContainer').html('');

      //商品清單
      for (let cart of result) {
        let price = cart.ticket.price;

        if (cart.ticket.promotion) {
          price = cart.ticket.promotion.price;
        }

        let showAvailable = cart.ticket.available < 10;
        if (cart.quantity > cart.ticket.available) {
          cart.quantity = cart.ticket.available;
          showAvailable = true;
        }


        $('#orderContainer').append(`
          <div class="row order-item align-items-center m-3 h-100">
            <div class="col-12 col-lg-2 h-100">
              <img src="${cart.ticket.image}" class="img-fluid rounded-start">
            </div>
            <div class="col-12 col-lg-3">
              <div class="h6">${cart.ticket.name}</div>
              <div class="text-muted"> ${cart.ticket.description}</div>
            </div>
            <div class="col-12 col-lg-2 my-text-lightblue text-center">
              <span class="item-price"> ${price}</span> 元
            </div>
            <div class="col-12 col-lg-2">
              <div class="input-group input-group">
                <button class="btn btn-primary btn-minus" type="button" data-id="${cart.ticket.ticketId}">-</button>
                <input type="text" class="form-control count-text"
                       value="${cart.quantity}" max="${cart.ticket.available}" disabled>
                <button class="btn btn-primary btn-plus" type="button" data-id="${cart.ticket.ticketId}"">+</button>
              </div>
              <p class="${showAvailable ? "" : "d-none"} text-center">剩餘庫存:${cart.ticket.available}</p>
            </div>
            <div class="col-12 col-lg-2 my-text-lightblue text-center">
              小計
              <span class="item-subtotal">${cart.quantity * price}</span> 元
            </div>
            <div class="col-12 col-lg-1">
              <button class="btn btn-primary btn-del" type="button" data-bs-toggle="modal"
                data-bs-target="#confirmModal" data-bs-whatever="${cart.ticket.ticketId}">
                <i class="fa fa-trash"></i>
              </button>
            </div>
            <hr class="mt-3 mb-3">
          </div>
        `);
      }

      render_coupons();
      //計算價格
      render_price();
    }

    /**
    *  渲染優惠券下拉式選單
    */
    function render_coupons() {
      $('#discountSelect').html(`<option value="0" selected>請選擇折扣碼</option>`);
      for (let coupon of coupons) {
        $('#discountSelect').append(
          `<option value="${coupon.couponId}">${coupon.name}</option>`
        );
      }
    }

    // 計算小計金額
    function render_subtotal(theText) {
      let quantity = parseInt($(theText).val());
      let price = parseInt($(theText).closest('.order-item').find('.item-price').text());
      $(theText).closest('.order-item').find('.item-subtotal').text(quantity * price);
    }

    // 計算總金額
    function render_price() {
      const sumSubtotal = $('.item-subtotal').toArray().reduce((sum, cur) => sum + parseInt(cur.textContent), 0);

      let discount = 0;
      const couponId = parseInt($('#discountSelect').val());
      if (couponId) {
        discount = coupons.find(e => e.couponId == couponId).discount;
      }


      const actualPrice = Math.max((sumSubtotal - discount), 1);

      $('#sumSubtotal').text(sumSubtotal);
      $('#actualPrice').text(actualPrice);
    }

  </script>
</body>
<!-- login顯示 -->
<script src="./js/Login.js"></script>
<!-- login顯示 -->



</html>